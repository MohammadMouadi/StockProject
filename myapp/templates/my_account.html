{% extends "base.html" %}

{% block content %}

{% csrf_token %}


<script>
function myFunction() {
  var x = document.getElementById("money-table");
      if (x.style.display !== "none") {
        x.style.display = "none";
      } else {
        x.style.display = "block";
      }
}
</script>

<form action="updatemyaccount" method="post">
    {% csrf_token %}
    <div class="row-8 my-3 ">
        <div class="d-flex flex-column align-items-start  col-6 ">
            {{frm_user.username.label_tag}}
            {{frm_user.username}}
        </div>
    </div>
    <div class=" d-flex flex-row ">
        <div class="col-4 d-flex flex-column align-items-start   ">
            {{frm_user.first_name.label_tag}}
            {{frm_user.first_name}}
        </div>
        <div class="col-4 d-flex flex-column align-items-start   ">
            {{frm_user.last_name.label_tag}}
            {{frm_user.last_name}}
        </div>
    </div>
    <div class="row-8 my-3 ">
        <div class="d-flex flex-column align-items-start  col-6 ">
            {{frm_user.email.label_tag}}
            {{frm_user.email}}
        </div>
    </div>


    <div class="row-8 my-3 text-right">
        <input class="btn btn-primary" type="submit" value="Save">
        <a href="{% url 'trade' %}" class="btn btn-primary">Stock Trading</a>
        <a href="{% url 'money' %}" id="button" class="btn btn-primary" onclick="myFunction()">Show Amount Of Money</a>

    </div>

    {% if messages %}
        {% for message in messages %}
            {% if message.tags %}
                <div class="alert alert-success" role="alert">{{ message }}</div>
            {% endif %}>
        {% endfor %}
    {% endif %}
</form>


<div id = "money-table">
<div class = "align-items-start">
    <h3> Your stocks and balance worth: {{ money }}</h3>
    <h3> Your balance is: {{ balance}}</h3>
    <h3> Your current stocks:</h3>


<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">Stock</th>
            <th scope="col">Quantity</th>
            <th scope="col">Stock Recent Price</th>
            <th scope="col">Total Stock Price</th>

        </tr>
    </thead>
    <tbody>
        {% for stock_symbol, data in stocks_data.items %}
            <tr>
                <td>{{stock_symbol}}</td>
                <td>{{data.quantity}}</td>
                <td>{{data.current_price}}</td>
                <td >{{data.total_stock_price}}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
</div>





</div>
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">Stock</th>
            <th scope="col">Date</th>
            <th scope="col">Buy/Sell</th>
            <th scope="col">Quantity</th>
            <th scope="col">Stock Price</th>

        </tr>
    </thead>
    <tbody>
        {% for trans in stock_transactions %}
            <tr>
                <td>{{trans.stock_symbol}}</td>
                <td>{{trans.trans_date_time|date:"Y-m-d H:i" }}</td>
                {% if trans.quantity > 0 %}
                    <td><i class="text-success fa fa-angle-double-left fa-2x"></i></td>
                {% elif  trans.quantity < 0  %}
                    <td><i class="text-danger fa fa-angle-double-right fa-2x"></i></td>
                {% endif %}
                <td>{{trans.quantity}}</td>
                <td>{{trans.price}}</td>

            </tr>
        {% endfor %}
    </tbody>
</table>



{% endblock %}





